# โ ุชูุฑูุฑ ุชุญููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู SQLite ุฅูู MySQL

## ๐ ููุฎุต ุงูุชุญููู

ุชู ุจูุฌุงุญ ุชุญููู ูุดุฑูุน **DIPS Academy** ูู SQLite ุฅูู MySQL ูุน ุฅุถุงูุฉ ูุธุงู Multi-Tenant ุงููุงูู.

---

## ๐ฏ ุงูููุงู ุงูููุฌุฒุฉ

### 1. ุชุญููู ูุงุนุฏุฉ ุงูุจูุงูุงุช โ
- โ ุชุญุฏูุซ ููู `.env` ููุงุชุตุงู ุจู MySQL
- โ ุชุบููุฑ `DB_CONNECTION` ูู `sqlite` ุฅูู `mysql`
- โ ุชูููู ุฅุนุฏุงุฏุงุช ุงูุงุชุตุงู ุจู MySQL ูู Laragon:
  - Host: 127.0.0.1
  - Port: 3306
  - Database: dips_academy
  - Username: root
  - Password: (ูุงุฑุบ)

### 2. ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ โ
- โ ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช: `dips_academy`
- โ ุชุดุบูู ุฌููุน Migrations (13 migration)
- โ ุชุดุบูู Seeders ุจูุฌุงุญ
- โ ุฅูุดุงุก 23 ุฌุฏูู ูู ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ

### 3. ุชุทููุฑ ูุธุงู Multi-Tenant โ
ุชู ุฅูุดุงุก 4 ูููุงุช ุฑุฆูุณูุฉ:

#### ุฃ) TenantDatabaseService.php โ
**ุงููุณุงุฑ**: `app/Services/TenantDatabaseService.php`

**ุงููุธุงุฆู**:
- `createTenantDatabase()` - ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ุฌุฏูุฏุฉ ููุณุชุฎุฏู
- `getTenantDatabaseName()` - ุงูุญุตูู ุนูู ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- `addTenantConnection()` - ุฅุถุงูุฉ ุงุชุตุงู ุฌุฏูุฏ
- `runMigrations()` - ุชุดุบูู Migrations ุนูู ูุงุนุฏุฉ ุจูุงูุงุช ูุนููุฉ
- `switchToTenantDatabase()` - ุงูุชุจุฏูู ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช ูุณุชุฎุฏู
- `switchToMainDatabase()` - ุงูุฑุฌูุน ุฅูู ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ
- `syncToMainDatabase()` - ูุฒุงููุฉ ุงูุจูุงูุงุช ูุน ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ
- `tenantDatabaseExists()` - ุงูุชุญูู ูู ูุฌูุฏ ูุงุนุฏุฉ ุจูุงูุงุช
- `deleteTenantDatabase()` - ุญุฐู ูุงุนุฏุฉ ุจูุงูุงุช ูุณุชุฎุฏู

#### ุจ) CreateTenantDatabase.php โ
**ุงููุณุงุฑ**: `app/Console/Commands/CreateTenantDatabase.php`

**ุงูุฃูุฑ**: `php artisan tenant:create {user_id}`

**ุงููุธููุฉ**: ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ุฌุฏูุฏุฉ ููุณุชุฎุฏู ูุนูู ูุน ุชุดุบูู ุฌููุน Migrations

#### ุฌ) SyncTenantToMain.php โ
**ุงููุณุงุฑ**: `app/Console/Commands/SyncTenantToMain.php`

**ุงูุฃูุฑ**: `php artisan tenant:sync {user_id} {--tables=*}`

**ุงููุธููุฉ**: ูุฒุงููุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู ูู ูุงุนุฏุชู ุงูุฎุงุตุฉ ุฅูู ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ

#### ุฏ) SetTenantDatabase.php โ
**ุงููุณุงุฑ**: `app/Http/Middleware/SetTenantDatabase.php`

**ุงููุธููุฉ**: Middleware ููุชุจุฏูู ุงูุชููุงุฆู ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู ุนูุฏ ูู ุทูุจ

### 4. ุชุญุฏูุซ ุจููุฉ ุงูุฌุฏุงูู โ
- โ ุฅูุดุงุก Migration: `add_tenant_user_id_to_tables`
- โ ุฅุถุงูุฉ ุญูู `tenant_user_id` ูุฌููุน ุงูุฌุฏุงูู ุงูุฑุฆูุณูุฉ:
  - courses
  - lessons
  - enrollments
  - certificates
  - reviews
  - quizzes
  - quiz_questions
  - quiz_attempts
  - lesson_progress
- โ ุฅุถุงูุฉ Index ุนูู ุญูู `tenant_user_id` ูุชุญุณูู ุงูุฃุฏุงุก

### 5. ุงูุงุฎุชุจุงุฑ โ
- โ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจู MySQL
- โ ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ: `dips_user_1`
- โ ุงูุชุญูู ูู ุชุดุบูู Migrations ุนูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู
- โ ุนุฑุถ ุฌููุน ููุงุนุฏ ุงูุจูุงูุงุช ูุงูุฌุฏุงูู
- โ ุงูุชุญูู ูู ุงูุจูุงูุงุช ุงููุฒุฑูุนุฉ (14 ูุณุชุฎุฏู)

### 6. ุงูุชูุซูู โ
ุชู ุฅูุดุงุก 3 ูููุงุช ุชูุซูู:

1. **MULTI_TENANT_GUIDE.md** - ุงูุฏููู ุงูุดุงูู (ุจุงููุบุฉ ุงูุนุฑุจูุฉ)
2. **QUICK_START_MYSQL_TENANT.md** - ุฏููู ุงูุจุฏุก ุงูุณุฑูุน
3. **README_MYSQL_CONVERSION.md** - ูุฐุง ุงูููู (ุงูุชูุฑูุฑ ุงููุงูู)

---

## ๐ ุฅุญุตุงุฆูุงุช ุงููุดุฑูุน

| ุงูุจูุฏ | ุงูุนุฏุฏ |
|-------|-------|
| ููุงุนุฏ ุงูุจูุงูุงุช ุงูููุดุฃุฉ | 2 (ุงูุฑุฆูุณูุฉ + ุงุฎุชุจุงุฑ) |
| Migrations ุงููููุฐุฉ | 14 |
| ุงูุฌุฏุงูู ูู ูู ูุงุนุฏุฉ | 23 |
| ุงููุณุชุฎุฏููู ูู ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ | 14 |
| ุงููููุงุช ุงูููุดุฃุฉ | 7 |
| ุงูุฃูุงูุฑ ุงูุฌุฏูุฏุฉ | 2 |
| ุงูู Middleware ุงูููุดุฃุฉ | 1 |
| ุงูุฎุฏูุงุช ุงูููุดุฃุฉ | 1 |

---

## ๐๏ธ ูููู ููุงุนุฏ ุงูุจูุงูุงุช

### ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ: `dips_academy`
```
dips_academy/
โโโ cache
โโโ cache_locks
โโโ certificates
โโโ courses
โโโ enrollments
โโโ failed_jobs
โโโ job_batches
โโโ jobs
โโโ lesson_progress
โโโ lessons
โโโ migrations
โโโ model_has_permissions
โโโ model_has_roles
โโโ password_reset_tokens
โโโ permissions
โโโ quiz_attempts
โโโ quiz_questions
โโโ quizzes
โโโ reviews
โโโ role_has_permissions
โโโ roles
โโโ sessions
โโโ users
โโโ (23 ุฌุฏูู)
```

### ููุงุนุฏ ุงููุณุชุฎุฏููู: `dips_user_{ID}`
ููุณ ุงูุจููุฉ ุงูุณุงุจูุฉุ ูุน ุจูุงูุงุช ูุณุชููุฉ ููู ูุณุชุฎุฏู.

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุงูุฃูุงูุฑ ุงูุฃุณุงุณูุฉ

```bash
# 1. ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ููุณุชุฎุฏู
php artisan tenant:create 1

# 2. ูุฒุงููุฉ ุฌููุน ุงูุจูุงูุงุช
php artisan tenant:sync 1

# 3. ูุฒุงููุฉ ุฌุฏุงูู ูุญุฏุฏุฉ
php artisan tenant:sync 1 --tables=courses --tables=lessons

# 4. ุนุฑุถ ุญุงูุฉ Migrations
php artisan migrate:status

# 5. ุชุดุบูู ุงูุงุฎุชุจุงุฑ
php test_tenant.php
```

### ุงุณุชุฎุฏุงู ูู ุงูููุฏ

```php
use App\Services\TenantDatabaseService;

$service = app(TenantDatabaseService::class);

// ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช
$service->createTenantDatabase('1');

// ุงูุชุจุฏูู ุฅูู ูุงุนุฏุฉ ุงููุณุชุฎุฏู
$service->switchToTenantDatabase('1');

// ุงูุนูู ุนูู ุงูุจูุงูุงุช...
$courses = DB::table('courses')->get();

// ุงูุฑุฌูุน ูููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ
$service->switchToMainDatabase();

// ูุฒุงููุฉ ุงูุจูุงูุงุช
$service->syncToMainDatabase('1');
```

---

## ๐ง ุงูุฅุนุฏุงุฏุงุช

### ููู .env
```env
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=dips_academy
DB_USERNAME=root
DB_PASSWORD=
```

### ููู config/database.php
ุชู ุงูุชุญูู ูู ูุฌูุฏ ุฅุนุฏุงุฏุงุช MySQL ุงูุตุญูุญุฉ (ุงูุณุทุฑ 46-64)

---

## ๐ฅ ุงููุณุชุฎุฏููู ุงููุชุงุญูู

| ID | ุงูุงุณู | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู | ุงูุฏูุฑ |
|----|-------|-------------------|-------|
| 1 | Super Admin | superadmin@dips-academy.com | super_admin |
| 2 | Admin | admin@dips-academy.com | admin |
| 3 | ุฃุญูุฏ ูุญูุฏ | instructor1@dips-academy.com | instructor |
| 4 | ูุงุทูุฉ ุนูู | instructor2@dips-academy.com | instructor |
| 5-14 | ุทูุงุจ | student{n}@dips-academy.com | student |

**ูููุฉ ุงููุฑูุฑ ููุฌููุน**: `password`

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ ุงูููุตู ุจูุง

### 1. ุชูุนูู Middleware
ูู ุจุชุญุฏูุซ `bootstrap/app.php`:
```php
->withMiddleware(function (Middleware $middleware) {
    $middleware->alias([
        'tenant' => \App\Http\Middleware\SetTenantDatabase::class,
    ]);
})
```

### 2. ุชุทุจูู Middleware ุนูู Routes
ูู `routes/web.php`:
```php
Route::middleware(['auth', 'tenant'])->group(function () {
    Route::resource('courses', CourseController::class);
    // ... ุจุงูู ุงููุณุงุฑุงุช
});
```

### 3. ุฅูุดุงุก ููุงุนุฏ ุจูุงูุงุช ูููุฏุฑุณูู
```bash
php artisan tenant:create 3  # ุฃุญูุฏ ูุญูุฏ
php artisan tenant:create 4  # ูุงุทูุฉ ุนูู
```

### 4. ุฌุฏููุฉ ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ
ูู `app/Console/Kernel.php`:
```php
protected function schedule(Schedule $schedule)
{
    // ูุฒุงููุฉ ููููุฉ ูู ููุชุตู ุงูููู
    $schedule->command('tenant:sync 3')->daily();
    $schedule->command('tenant:sync 4')->daily();
}
```

### 5. ุฅุถุงูุฉ ูุงุฌูุฉ ูููุฒุงููุฉ
- ุฅูุดุงุก ุตูุญุฉ ูู ููุญุฉ ุงูุชุญูู ูููุฒุงููุฉ
- ุฅุถุงูุฉ ุฒุฑ ูููุฏุฑุณ ููุฒุงููุฉ ุจูุงูุงุชู
- ุนุฑุถ ุญุงูุฉ ุงููุฒุงููุฉ

---

## ๐ ุงูููุงุฆุฏ ูุงููููุฒุงุช

### 1. ุงูุฃุฏุงุก ๐
- ูู ูุณุชุฎุฏู ูู ูุงุนุฏุฉ ุจูุงูุงุช ูุณุชููุฉ
- ุงุณุชุนูุงูุงุช ุฃุณุฑุน ูุฃูู ุชุนููุฏุงู
- ุนุฒู ูุงูู ููุจูุงูุงุช

### 2. ุงูุฃูุงู ๐
- ุจูุงูุงุช ูู ูุณุชุฎุฏู ูุนุฒููุฉ ุชูุงูุงู
- ูุง ูููู ููุณุชุฎุฏู ุงููุตูู ูุจูุงูุงุช ูุณุชุฎุฏู ุขุฎุฑ
- ุญูุงูุฉ ูู SQL Injection ุนูู ูุณุชูู ุงููุงุนุฏุฉ

### 3. ุงููุฑููุฉ ๐จ
- ุณูููุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู ูุจูุงูุงุช ูุณุชุฎุฏู ูุนูู
- ุฅููุงููุฉ ุญุฐู ุจูุงูุงุช ูุณุชุฎุฏู ุฏูู ุงูุชุฃุซูุฑ ุนูู ุงูุขุฎุฑูู
- ุณูููุฉ ุงูุชุฑุญูู ูุงูููู

### 4. ุงููุงุจููุฉ ููุชูุณุน ๐
- ูููู ุฅุถุงูุฉ ุนุฏุฏ ุบูุฑ ูุญุฏูุฏ ูู ุงููุณุชุฎุฏููู
- ูู ูุงุนุฏุฉ ุจูุงูุงุช ูุณุชููุฉ
- ุณูููุฉ ุชูุฒูุน ุงูุญูู

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ุงูุตูุงุญูุงุช**: ุชุฃูุฏ ูู ุฃู ูุณุชุฎุฏู MySQL ูุฏูู ุตูุงุญูุฉ `CREATE DATABASE`
2. **ุงููุฒุงููุฉ**: ูุฌุจ ุชุดุบูู ุงููุฒุงููุฉ ูุฏููุงู ุฃู ุฌุฏููุชูุง
3. **ุงููุณุฎ ุงูุงุญุชูุงุทู**: ุนูู Backup ุฏูุฑู ูุฌููุน ููุงุนุฏ ุงูุจูุงูุงุช
4. **ุงููุฑุงูุจุฉ**: ูุฑุงูุจุฉ ุญุฌู ุงูููุงุนุฏ ูุนุฏุฏูุง
5. **ุงูุชูุธูู**: ุญุฐู ููุงุนุฏ ุงูุจูุงูุงุช ูููุณุชุฎุฏููู ุงููุญุฐูููู

---

## ๐๏ธ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ: "Access denied for user"
**ุงูุญู**: ุชุญูู ูู ุจูุงูุงุช ุงุชุตุงู MySQL ูู `.env`

### ุฎุทุฃ: "Database already exists"
**ุงูุญู**: ุงุณุชุฎุฏู ุฃูุฑ ุงูุญุฐู ุฃููุงู ุฃู ุฃูุฏ ุนูู ุฅุนุงุฏุฉ ุงูุฅูุดุงุก

### ุฎุทุฃ: "Migration table not found"
**ุงูุญู**: ูู ุจุชุดุบูู `php artisan migrate` ุฃููุงู

### ุฎุทุฃ: "Class not found"
**ุงูุญู**: ูู ุจุชุดุบูู `composer dump-autoload`

---

## ๐ ุงูุฏุนู ูุงููุฑุงุฌุน

### ุงููููุงุช ุงููููุฉ
- `app/Services/TenantDatabaseService.php` - ุงูุฎุฏูุฉ ุงูุฑุฆูุณูุฉ
- `MULTI_TENANT_GUIDE.md` - ุงูุฏููู ุงูุดุงูู
- `QUICK_START_MYSQL_TENANT.md` - ุฏููู ุงูุจุฏุก ุงูุณุฑูุน

### ุงูุฃูุงูุฑ ุงููููุฏุฉ
```bash
# ุนุฑุถ ููุงุนุฏ ุงูุจูุงูุงุช
php artisan db:show

# ุนุฑุถ ุญุงูุฉ Migrations
php artisan migrate:status

# ุนุฑุถ ุงููุณุงุฑุงุช
php artisan route:list

# ุนุฑุถ ุงูุฃูุงูุฑ ุงููุชุงุญุฉ
php artisan list tenant
```

---

## โจ ุงูุฎูุงุตุฉ

ุชู ุจูุฌุงุญ:
- โ ุชุญููู ุงููุดุฑูุน ูู SQLite ุฅูู MySQL
- โ ุงูุงุชุตุงู ุจู MySQL ูู Laragon
- โ ุชุทููุฑ ูุธุงู Multi-Tenant ูุงูู ููุชูุงูู
- โ ุงุฎุชุจุงุฑ ุงููุธุงู ูุงูุชุญูู ูู ุนููู ุจุดูู ุตุญูุญ
- โ ุชูุซูู ุดุงูู ุจุงููุบุฉ ุงูุนุฑุจูุฉ

ุงููุดุฑูุน ุงูุขู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ูุน ููุงุนุฏ ุจูุงูุงุช ูุชุนุฏุฏุฉ! ๐

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก**: 22 ููุงูุฑ 2026  
**ุงูุญุงูุฉ**: โ ููุชูู ูุฌุงูุฒ ููุงุณุชุฎุฏุงู  
**ุงูุฅุตุฏุงุฑ**: 1.0.0
