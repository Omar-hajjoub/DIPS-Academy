# ๐ ุงูุจุฏุก ุงูุณุฑูุน - ูุธุงู ููุงุนุฏ ุงูุจูุงูุงุช ุงููุชุนุฏุฏุฉ

## โ ูุง ุชู ุฅูุฌุงุฒู

ุชู ุชุญููู ุงููุดุฑูุน ุจูุฌุงุญ ูู **SQLite** ุฅูู **MySQL** ูุน ุฅุถุงูุฉ ูุธุงู **Multi-Tenant** (ููุงุนุฏ ุจูุงูุงุช ูุชุนุฏุฏุฉ).

### ุงูุฅูุฌุงุฒุงุช:
1. โ ุชุญููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู SQLite ุฅูู MySQL
2. โ ุงูุงุชุตุงู ุจู MySQL ูู Laragon
3. โ ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ: `dips_academy`
4. โ ุฅูุดุงุก ูุธุงู Multi-Tenant ูุงูู
5. โ ุชุดุบูู ุฌููุน Migrations ุจูุฌุงุญ
6. โ ุงุฎุชุจุงุฑ ุงููุธุงู ูุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ

## ๐ ูุนูููุงุช ุงูููุงุนุฏ ุงูููุฌูุฏุฉ

### ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ
- **ุงูุงุณู**: `dips_academy`
- **ุงููุตู**: ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ ุงูุชู ุชุญุชูู ุนูู ุฌููุน ุงูุจูุงูุงุช ุงููุดุชุฑูุฉ
- **ุงูุฌุฏุงูู**: 23 ุฌุฏูู

### ููุงุนุฏ ุงููุณุชุฎุฏููู
- **ุงูููุท**: `dips_user_{USER_ID}`
- **ูุซุงู**: `dips_user_1` (ุชู ุฅูุดุงุคูุง ูุงุฎุชุจุงุฑ)
- **ุงูุฌุฏุงูู**: 23 ุฌุฏูู (ููุณ ุจููุฉ ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ)

## ๐ฏ ุงูุงุณุชุฎุฏุงู ุงูุฃุณุงุณู

### 1๏ธโฃ ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ููุณุชุฎุฏู ุฌุฏูุฏ

```bash
php artisan tenant:create USER_ID
```

**ูุซุงู**:
```bash
# ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช ูููุณุชุฎุฏู ุฑูู 2
php artisan tenant:create 2
```

### 2๏ธโฃ ูุฒุงููุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู ูุน ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ

```bash
# ูุฒุงููุฉ ุฌููุน ุงูุจูุงูุงุช
php artisan tenant:sync USER_ID

# ูุฒุงููุฉ ุฌุฏุงูู ูุญุฏุฏุฉ ููุท
php artisan tenant:sync USER_ID --tables=courses --tables=lessons
```

**ูุซุงู**:
```bash
# ูุฒุงููุฉ ุฌููุน ุจูุงูุงุช ุงููุณุชุฎุฏู 1
php artisan tenant:sync 1

# ูุฒุงููุฉ ุงูุฏูุฑุงุช ูุงูุฏุฑูุณ ููุท
php artisan tenant:sync 1 --tables=courses --tables=lessons
```

## ๐ป ุฃูุซูุฉ ุจุฑูุฌูุฉ

### ูุซุงู 1: ุงูุนูู ูุน ูุงุนุฏุฉ ุจูุงูุงุช ูุณุชุฎุฏู ูุนูู

```php
use App\Services\TenantDatabaseService;
use App\Models\Course;

$tenantService = app(TenantDatabaseService::class);
$userId = 1;

// ุงูุชุจุฏูู ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู
$tenantService->switchToTenantDatabase($userId);

// ุฅูุดุงุก ุฏูุฑุฉ ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู
$course = Course::create([
    'title' => 'ุฏูุฑุฉ Laravel',
    'description' => 'ุฏูุฑุฉ ุดุงููุฉ',
    'instructor_id' => $userId,
]);

// ุงูุฑุฌูุน ุฅูู ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ
$tenantService->switchToMainDatabase();
```

### ูุซุงู 2: ุงุณุชุฎุฏุงู Middleware ููุชุจุฏูู ุงูุชููุงุฆู

ุฃููุงูุ ุณุฌู Middleware ูู `bootstrap/app.php`:

```php
return Application::configure(basePath: dirname(__DIR__))
    ->withMiddleware(function (Middleware $middleware) {
        $middleware->alias([
            'tenant' => \App\Http\Middleware\SetTenantDatabase::class,
        ]);
    })
    // ... rest of config
```

ุซู ุงุณุชุฎุฏูู ูู routes:

```php
// ูู routes/web.php
Route::middleware(['auth', 'tenant'])->group(function () {
    // ุฌููุน ุงูุนูููุงุช ููุง ุณุชููู ุนูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู ุงูุญุงูู
    Route::get('/my-courses', [CourseController::class, 'index']);
    Route::post('/courses', [CourseController::class, 'store']);
});
```

## ๐ ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู

### ุงูุณููุงุฑูู 1: ูุฏุฑุณ ูุถูู ุฏูุฑุฉ ุฌุฏูุฏุฉ
```bash
# ุงููุธุงู ุชููุงุฆูุงู ุณูุญูุธ ุงูุฏูุฑุฉ ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุฏุฑุณ
# ุนูุฏ ุงุณุชุฎุฏุงู Middleware 'tenant'
```

### ุงูุณููุงุฑูู 2: ูุฒุงููุฉ ุฏูุฑุงุช ุงููุฏุฑุณ ูุน ุงููุงุนุฏุฉ ุงูุนุงูุฉ
```bash
php artisan tenant:sync 3
# ุงููุฏุฑุณ ุฑูู 3 ุณูุชู ูุฒุงููุฉ ุฌููุน ุฏูุฑุงุชู ูุน ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ
```

### ุงูุณููุงุฑูู 3: ุนุฑุถ ุฌููุน ุงูุฏูุฑุงุช ูู ุฌููุน ุงููุฏุฑุณูู
```php
// ูู ุงููุงุนุฏุฉ ุงูุฑุฆูุณูุฉ
$allCourses = Course::all();

// ุฏูุฑุงุช ูุฏุฑุณ ูุญุฏุฏ
$instructorCourses = Course::where('tenant_user_id', '3')->get();
```

## ๐ง ุฅุนุฏุงุฏุงุช MySQL ูู Laragon

ุงูุฅุนุฏุงุฏุงุช ุงูุญุงููุฉ ูู `.env`:
```env
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=dips_academy
DB_USERNAME=root
DB_PASSWORD=
```

## ๐ ุงููููุงุช ุงููููุฉ

| ุงูููู | ุงููุตู |
|-------|-------|
| `app/Services/TenantDatabaseService.php` | ุฎุฏูุฉ ุฅุฏุงุฑุฉ ููุงุนุฏ ุงูุจูุงูุงุช ุงููุชุนุฏุฏุฉ |
| `app/Console/Commands/CreateTenantDatabase.php` | ุฃูุฑ ุฅูุดุงุก ูุงุนุฏุฉ ุจูุงูุงุช |
| `app/Console/Commands/SyncTenantToMain.php` | ุฃูุฑ ุงููุฒุงููุฉ |
| `app/Http/Middleware/SetTenantDatabase.php` | Middleware ุงูุชุจุฏูู ุงูุชููุงุฆู |
| `MULTI_TENANT_GUIDE.md` | ุงูุฏููู ุงูุดุงูู |

## ๐งช ุงุฎุชุจุงุฑ ุงููุธุงู

ูุงุฎุชุจุงุฑ ุงููุธุงู:
```bash
php test_tenant.php
```

ูุฐุง ุณูุนุฑุถ:
- ููุงุนุฏ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ
- ุญุงูุฉ ูุงุนุฏุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู
- ุนุฏุฏ ุงูุฌุฏุงูู
- ุงููุณุชุฎุฏููู ุงูููุฌูุฏูู

## ๐ ุงููุณุชุฎุฏููู ุงููุชุงุญูู ููุงุฎุชุจุงุฑ

| ID | ุงูุงุณู | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู | ุงูุฏูุฑ |
|----|-------|-------------------|-------|
| 1 | Super Admin | superadmin@dips-academy.com | ุงููุฏูุฑ ุงูุฃุนูู |
| 2 | Admin | admin@dips-academy.com | ูุฏูุฑ |
| 3 | ุฃุญูุฏ ูุญูุฏ | instructor1@dips-academy.com | ูุฏุฑุณ |
| 4 | ูุงุทูุฉ ุนูู | instructor2@dips-academy.com | ูุฏุฑุณ |
| 5-14 | ุทูุงุจ | student1@dips-academy.com | ุทุงูุจ |

**ูููุฉ ุงููุฑูุฑ ููุฌููุน**: `password`

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุฅูุดุงุก ููุงุนุฏ ุจูุงูุงุช ูููุฏุฑุณูู**:
   ```bash
   php artisan tenant:create 3
   php artisan tenant:create 4
   ```

2. **ุชูุนูู Middleware ูู routes**:
   - ูู ุจุชุญุฏูุซ `bootstrap/app.php`
   - ุฃุถู Middleware ูููุณุงุฑุงุช ุงููุทููุจุฉ

3. **ุงุฎุชุจุงุฑ ุฅุถุงูุฉ ุจูุงูุงุช**:
   - ูู ุจุชุณุฌูู ุงูุฏุฎูู ููุฏุฑุณ
   - ุฃุถู ุฏูุฑุฉ ุฌุฏูุฏุฉ
   - ุชุญูู ูู ุญูุธูุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ

4. **ุงุฎุชุจุงุฑ ุงููุฒุงููุฉ**:
   ```bash
   php artisan tenant:sync 3
   ```

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ุงูุฃุฏุงุก**: ูู ูุณุชุฎุฏู ูู ูุงุนุฏุฉ ุจูุงูุงุช ูุณุชููุฉ - ุฃุฏุงุก ุฃูุถู ูุนุฒู ูุงูู
2. **ุงููุฒุงููุฉ**: ูุฌุจ ุชุดุบูู ุงููุฒุงููุฉ ูุฏููุงู ุฃู ุฌุฏููุชูุง
3. **ุงููุณุฎ ุงูุงุญุชูุงุทู**: ูุง ุชูุณู ุนูู Backup ูุฌููุน ุงูููุงุนุฏ
4. **ุงูุตูุงุญูุงุช**: ูุณุชุฎุฏู MySQL ูุญุชุงุฌ ุตูุงุญูุฉ CREATE DATABASE

## ๐ ูุจุฑูู!

ุชู ุชุญููู ุงููุดุฑูุน ุจูุฌุงุญ ุฅูู MySQL ูุน ูุธุงู Multi-Tenant ูุงูู! ๐

ูููุฒูุฏ ูู ุงูุชูุงุตููุ ุฑุงุฌุน `MULTI_TENANT_GUIDE.md`
